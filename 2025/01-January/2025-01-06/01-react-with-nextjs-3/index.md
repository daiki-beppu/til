---
date: 2025-01-06
time: 07:04:20
title: react-with-nextjs-3
number: 01
labels: [react, next.js]
topics: [js/react]
---

## 💡 学んだことの要約

React / Next.js の続き

### 内容

`CSS Modules` を使うことで `CSS` の管理が楽になる
とくに命名の衝突を避けるのに有効

同じ名前を複数使用してもお互いに影響なく使い分ける事ができる
他にも解決する手法はいろいろある

- `CSS in JS` (ライブラリを用いる方法)
- `Tailwind CSS` (CSS フレームワークを用いる方法)

`CSS Modules` は `React` などで実装しようとするとけっこう大変らしい
だが Next.js には `built in` (備え付け)されているので非常に使いやすい

`React` では `class` ではなく `className` を使用する

`Home.module.css` は絶対にクラスセレクターでなければならない

`CSS Modules` も `React` と同様にコンポーネント思考で分けるほうがいい

<details>
<summary>リファクタリング(クリックで開く)</summary>

ディレクトリ構造とmodule.css をコンポーネントそれぞれに分割

```
.
├── README.md
├── jsconfig.json
├── next.config.mjs
├── package.json
├── public
│   ├── favicon.ico
│   ├── file.svg
│   ├── globe.svg
│   ├── next.svg
│   ├── vercel.svg
│   └── window.svg
├── src
│   ├── components
│   │   ├── Footer
│   │   │   ├── Footer.module.css
│   │   │   └── index.jsx
│   │   ├── Header
│   │   │   ├── Header.module.css
│   │   │   └── index.jsx
│   │   ├── Headline
│   │   │   ├── Headline.module.css
│   │   │   └── index.jsx
│   │   ├── Links
│   │   │   ├── Links.module.css
│   │   │   └── index.jsx
│   │   └── Main
│   │       ├── Main.module.css
│   │       └── index.jsx
│   ├── pages
│   │   ├── _app.js
│   │   ├── _document.js
│   │   ├── about.jsx
│   │   ├── api
│   │   │   └── hello.js
│   │   └── index.jsx
│   └── styles
│       ├── Home.module.css
│       └── globals.css
└── yarn.lock
```

</details>

`index.jsx` を使用することでディレクトリ名を参照したとき
まずは `index.jsx` を探してくれるので無駄にパスが長くならなくてすむ

書いてみて思ったのは VSCode 上だとどのディレクトリの `index.jsx` なのかわかりにくいかもしれない
一応タブのところにパスが記述されているからわからなくはないが慣れの問題かもしれない

`_app.js` について

- `_app.js` で記述したものはすべてのページに反映される
- `_app.js` のようにこれ以上親がないものについてはフラグメントを使用するのもアリ

<details>
<summary> _app.js で Head タグを共通化(クリックで開く)</summary>

```jsx
/* eslint-disable react/prop-types */
import 'src/styles/globals.css';

import Head from 'next/head';

export default function App({ Component, pageProps }) {
  return (
    <>
      <Head>
        <title>Create Next App</title>
        <meta name="description" content="Generated by create next app" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <link rel="icon" href="/favicon.ico" />
      </Head>

      <Component {...pageProps} />
    </>
  );
}
```

</details>

繰り返しについて

`React` では 繰り返しは `for 文`ではなく `map` を使用する
また `map` を使用することでデータと処理を分けて記述できるため
可読性、メンテナンス性が高くなる

<details>
<summary>map を使用してリファクタリング(クリックで開く)</summary>

```jsx
import Image from 'next/image';
import styles from 'src/components/Footer/Footer.module.css';

const items = [
  {
    href: 'https://nextjs.org/learn?utm_source=create-next-app&utm_medium=default-template&utm_campaign=create-next-app',
    src: '/file.svg',
    alt: 'File icon',
    description: 'Learn',
  },
  {
    href: 'https://vercel.com/templates?framework=next.js&utm_source=create-next-app&utm_medium=default-template&utm_campaign=create-next-app',
    src: '/window.svg',
    alt: 'Window icon',
    description: 'Examples',
  },
  {
    href: 'https://nextjs.org?utm_source=create-next-app&utm_medium=default-template&utm_campaign=create-next-app',
    src: '/globe.svg',
    alt: 'Globe icon',
    description: ' Go to nextjs.org →',
  },
];

export default function Footer() {
  return (
    <footer className={styles.footer}>
      {items.map((item) => {
        return (
          <a
            key={item.href}
            href={item.href}
            target="_blank"
            rel="noopener noreferrer"
          >
            <Image
              aria-hidden
              src={item.src}
              alt={item.alt}
              width={16}
              height={16}
            />
            {item.description}
          </a>
        );
      })}
    </footer>
  );
}
```

</details>

### ハマったポイント

`map` 内でも`return` を記述しないといけない
`return` の記述漏れ

```jsx
export default function Footer() {
  return (
    <footer className={styles.footer}>
      {items.map((item) => {
        return (
          <a
            key={item.href}
            href={item.href}
            target="_blank"
            rel="noopener noreferrer"
          >
            <Image
              aria-hidden
              src={item.src}
              alt={item.alt}
              width={16}
              height={16}
            />
            {item.description}
          </a>
        );
      })}
    </footer>
  );
}
```

イベント処理について

関数はコンポーネント内、コンポーネント外でも記述可能

イベント内で処理を記述するのはコードの見通しが悪くなるのでおすすめしない
引数が長いものや煩雑なメソッドはコンポーネント内で定義するほうがいい
コンポーネント内の変数を使用する場合や引数を使用するときイベントの記述がわかりにくいものになる

ただし、コンポーネント内で定義する場合は注意が必要
コンポーネントが再レンダリングされるタイミングでコンポーネント内で定義されたメソッドも再生成されてしまうのでパフォーマンスが悪くなってしまう

`useCallback` を使用することで解決することができる
`useCallback` は再レンダリング時に再生成されないようにする `hooks`

1. `onClick` などの中では記述しない
2. 引数がない、もしくは 1 つやコンポーネント内の変数を使用しないシンプルなメソッドはコンポーネントの外に記述
3. 引数が多い、コンポーネント内の変数を使用する煩雑なメソッドはコンポーネント内に記述

## 🔍 気づき・感想

## 📚 参考リンク

## ⏭️ 次に学びたいこと

## 📌 関連する過去の学び

---
